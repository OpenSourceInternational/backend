/*
 * This file is part of the TYPO3 CMS project.
 *
 * It is free software; you can redistribute it and/or modify it under
 * the terms of the GNU General Public License, either version 2
 * of the License, or any later version.
 *
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
 *
 * The TYPO3 project - inspiring people to share!
 */
define(["require","exports","jquery","bootstrap","TYPO3/CMS/Backend/jquery.clearable"],function(a,b,c){"use strict";var d=function(){function a(){var a=this;this.showLoginProcess=function(){a.showLoadingIndicator(),c(a.options.error).addClass("hidden"),c(a.options.errorNoCookies).addClass("hidden")},this.showLoadingIndicator=function(){c(a.options.submitButton).button("loading")},this.handleSubmit=function(b){a.showLoginProcess(),"function"==typeof a.options.submitHandler&&a.options.submitHandler(b)},this.interfaceSelectorChanged=function(){var b=new Date,d=new Date(b.getTime()+31536e6);document.cookie="typo3-login-interface="+c(a.options.interfaceField).val()+"; expires="+d.toUTCString()+";"},this.checkForInterfaceCookie=function(){if(c(a.options.interfaceField).length){var b=document.cookie.indexOf("typo3-login-interface=");if(b!==-1){var d=document.cookie.substr(b+22);d=d.substr(0,d.indexOf(";")),c(a.options.interfaceField).val(d)}}},this.showCookieWarning=function(){c(a.options.formFields).addClass("hidden"),c(a.options.errorNoCookies).removeClass("hidden")},this.hideCookieWarning=function(){c(a.options.formFields).removeClass("hidden"),c(a.options.errorNoCookies).addClass("hidden")},this.checkCookieSupport=function(){var b=navigator.cookieEnabled;b===!1?a.showCookieWarning():document.cookie||null!==b||(document.cookie="typo3-login-cookiecheck=1",document.cookie?document.cookie="typo3-login-cookiecheck=; expires="+new Date(0).toUTCString():a.showCookieWarning())},this.initializeEvents=function(){c(document).ajaxStart(a.showLoadingIndicator),c(a.options.loginForm).on("submit",a.handleSubmit),c(a.options.interfaceField).length>0&&c(document).on("change blur",a.options.interfaceField,a.interfaceSelectorChanged),c(".t3js-clearable").clearable(),c(".t3js-login-news-carousel").on("slide.bs.carousel",function(a){var b=c(a.relatedTarget).height(),d=c(a.target);d.find("div.active").parent().animate({height:b},500)})},this.options={error:".t3js-login-error",errorNoCookies:".t3js-login-error-nocookies",formFields:".t3js-login-formfields",interfaceField:".t3js-login-interface-field",loginForm:"#typo3-login-form",submitButton:".t3js-login-submit",submitHandler:null,useridentField:".t3js-login-userident-field"},this.checkCookieSupport(),this.checkForInterfaceCookie(),this.initializeEvents(),top.location.href!==location.href&&(top.location.href=location.href)}return a}();return new d});