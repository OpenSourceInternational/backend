/*
 * This file is part of the TYPO3 CMS project.
 *
 * It is free software; you can redistribute it and/or modify it under
 * the terms of the GNU General Public License, either version 2
 * of the License, or any later version.
 *
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
 *
 * The TYPO3 project - inspiring people to share!
 */
define(["require","exports","jquery","./InfoWindow","./Modal","./Severity","./Viewport"],function(t,e,n,o,r,a,i){"use strict";return function(){function t(){}return t.getReturnUrl=function(){return top.rawurlencode(top.list_frame.document.location.pathname+top.list_frame.document.location.search)},t.editRecord=function(e,n){i.ContentContainer.setUrl(top.TYPO3.settings.FormEngine.moduleUrl+"&edit["+e+"]["+n+"]=edit&returnUrl="+t.getReturnUrl())},t.viewRecord=function(t,e){var o=n(this).data("preview-url");o&&window.open(o,"newTYPO3frontendWindow").focus()},t.openInfoPopUp=function(t,e){o.showItem(t,e)},t.mountAsTreeRoot=function(t,e){"pages"===t&&i.NavigationContainer.PageTree.setTemporaryMountPoint(e)},t.newPageWizard=function(e,n){i.ContentContainer.setUrl(top.TYPO3.settings.NewRecord.moduleUrl+"&id="+n+"&pagesOnly=1&returnUrl="+t.getReturnUrl())},t.newContentWizard=function(e,o){var r=n(this).data("new-wizard-url");r&&(r+="&returnUrl="+t.getReturnUrl(),i.ContentContainer.setUrl(r))},t.newRecord=function(e,n){i.ContentContainer.setUrl(top.TYPO3.settings.FormEngine.moduleUrl+"&edit["+e+"][-"+n+"]=new&returnUrl="+t.getReturnUrl())},t.openHistoryPopUp=function(e,n){i.ContentContainer.setUrl(top.TYPO3.settings.RecordHistory.moduleUrl+"&element="+e+":"+n+"&returnUrl="+t.getReturnUrl())},t.openListModule=function(t,e){var o="pages"===t?e:n(this).data("page-uid");top.TYPO3.ModuleMenu.App.showModule("web_list","id="+o)},t.pagesSort=function(t,e){var o=n(this).data("pages-sort-url");o&&i.ContentContainer.setUrl(o)},t.pagesNewMultiple=function(t,e){var o=n(this).data("pages-new-multiple-url");o&&i.ContentContainer.setUrl(o)},t.disableRecord=function(e,n){i.ContentContainer.setUrl(top.TYPO3.settings.RecordCommit.moduleUrl+"&data["+e+"]["+n+"][hidden]=1&redirect="+t.getReturnUrl()).done(function(){i.NavigationContainer.PageTree.refreshTree()})},t.enableRecord=function(e,n){i.ContentContainer.setUrl(top.TYPO3.settings.RecordCommit.moduleUrl+"&data["+e+"]["+n+"][hidden]=0&redirect="+t.getReturnUrl()).done(function(){i.NavigationContainer.PageTree.refreshTree()})},t.deleteRecord=function(e,o){var l=n(this);r.confirm(l.data("title"),l.data("message"),a.warning,[{text:n(this).data("button-close-text")||TYPO3.lang["button.cancel"]||"Cancel",active:!0,btnClass:"btn-default",name:"cancel"},{text:n(this).data("button-ok-text")||TYPO3.lang["button.delete"]||"Delete",btnClass:"btn-warning",name:"delete"}]).on("button.clicked",function(n){"delete"===n.target.getAttribute("name")&&i.ContentContainer.setUrl(top.TYPO3.settings.RecordCommit.moduleUrl+"&redirect="+t.getReturnUrl()+"&cmd["+e+"]["+o+"][delete]=1").done(function(){"pages"===e&&i.NavigationContainer.PageTree&&i.NavigationContainer.PageTree.refreshTree()}),r.dismiss()})},t.copy=function(e,o){var r=TYPO3.settings.ajaxUrls.contextmenu_clipboard+"&CB[el]["+e+"%7C"+o+"]=1&CB[setCopyMode]=1";n.ajax(r).always(function(){t.triggerRefresh(i.ContentContainer.get().location.href)})},t.clipboardRelease=function(e,o){var r=TYPO3.settings.ajaxUrls.contextmenu_clipboard+"&CB[el]["+e+"%7C"+o+"]=0";n.ajax(r).always(function(){t.triggerRefresh(i.ContentContainer.get().location.href)})},t.cut=function(e,o){var r=TYPO3.settings.ajaxUrls.contextmenu_clipboard+"&CB[el]["+e+"%7C"+o+"]=1&CB[setCopyMode]=0";n.ajax(r).always(function(){t.triggerRefresh(i.ContentContainer.get().location.href)})},t.triggerRefresh=function(t){-1===t.indexOf("record%2Fedit")&&i.ContentContainer.refresh(!0)},t.clearCache=function(t,e){var o=top.TYPO3.settings.WebLayout.moduleUrl+"&id="+e+"&clear_cache=1";n.ajax(o)},t.pasteAfter=function(e,o){t.pasteInto.bind(n(this))(e,-o)},t.pasteInto=function(e,o){var l=n(this),s=function(){var n="&CB[paste]="+e+"%7C"+o+"&CB[pad]=normal&redirect="+t.getReturnUrl();i.ContentContainer.setUrl(top.TYPO3.settings.RecordCommit.moduleUrl+n).done(function(){"pages"===e&&i.NavigationContainer.PageTree&&i.NavigationContainer.PageTree.refreshTree()})};l.data("title")?r.confirm(l.data("title"),l.data("message"),a.warning,[{text:n(this).data("button-close-text")||TYPO3.lang["button.cancel"]||"Cancel",active:!0,btnClass:"btn-default",name:"cancel"},{text:n(this).data("button-ok-text")||TYPO3.lang["button.ok"]||"OK",btnClass:"btn-warning",name:"ok"}]).on("button.clicked",function(t){"ok"===t.target.getAttribute("name")&&s(),r.dismiss()}):s()},t}()});